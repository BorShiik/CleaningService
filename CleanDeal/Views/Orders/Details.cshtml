@model CleanDeal.DTOs.CleaningOrderDTO
@{
    ViewData["Title"] = $"Zamówienie #{Model.Id}";
    Layout = "_Layout";
    bool isAdmin = User.IsInRole("Admin");
}

<h2>@ViewData["Title"]</h2>

<dl class="row">
    <dt class="col-sm-3">Data</dt>
    <dd class="col-sm-9">@Model.Date:g</dd>

    <dt class="col-sm-3">Adres</dt>
    <dd class="col-sm-9">@Model.Address</dd>

    <dt class="col-sm-3">Usługa</dt>
    <dd class="col-sm-9">@Model.ServiceTypeName</dd>

    <dt class="col-sm-3">Status</dt>
    <dd class="col-sm-9">@Model.Status</dd>

    <dt class="col-sm-3">Suma</dt>
    <dd class="col-sm-9">@Model.OrderTotal.ToString("c")</dd>

    <dt class="col-sm-3">Płatność</dt>
    <dd class="col-sm-9">
        @(Model.PaymentAmount?.ToString("c") ?? "—")
    </dd>

    <dt class="col-sm-3">Ocena</dt>
    <dd class="col-sm-9">
        @(Model.HasReview ? $"{Model.ReviewRating} / 5" : "Brak")
    </dd>
</dl>

<div class="mt-3">
    <a asp-action="Index" class="btn btn-secondary">Wróć</a>

    @if (Model.Status != "Ukończone")
    {
        <a asp-action="Edit" asp-route-id="@Model.Id"
           class="btn btn-primary">Edytuj</a>
    }

    @if (Model.PaymentAmount == null && Model.Status != "Ukończone")
    {
        <a asp-controller="Payments" asp-action="Checkout" asp-route-id="@Model.Id"
           class="btn btn-success">Zapłać</a>
    }

    @if (isAdmin || Model.Status != "Ukończone")
    {
        <form asp-action="Delete" asp-route-id="@Model.Id" method="post"
              onsubmit="return confirm('Usunąć?');" class="d-inline">
            <button class="btn btn-danger">Usuń</button>
        </form>
    }
</div>
