@model CleanDeal.DTOs.CleaningOrderDTO
@{
    ViewData["Title"] = $"Zlecenie #{Model.Id}";
    bool isAdmin = User.IsInRole("Admin");
}
<h2>Zamówienie #@Model.Id</h2>

<dl class="row">
    <dt class="col-sm-3">Data</dt>
    <dd class="col-sm-9">@Model.Date.ToString("f")</dd>

    <dt class="col-sm-3">Adres</dt>
    <dd class="col-sm-9">@Model.Address</dd>

    <dt class="col-sm-3">Usługa</dt>
    <dd class="col-sm-9">@Model.ServiceTypeName</dd>

    <dt class="col-sm-3">Status</dt>
    <dd class="col-sm-9">
        @(Model.Status switch
         {
             "Ukończone" => "Ukończone",
             "Oczekuje" => "Oczekuje",
             _ => "W toku"
         })
        @if (Model.IsPaid)
        {
            <span class="badge bg-success ms-1">Opłacone</span>
        }
        else
        {
            <span class="badge bg-danger ms-1">Nie opłacone</span>
        }
    </dd>

    <dt class="col-sm-3">Kwota</dt>
    <dd class="col-sm-9">
        @*(Model.PaymentAmount?.ToString("c") ?? "—")*@
        @(Model.TotalPrice ?? 0)
    </dd>
    <dt class="col-sm-3">Ocena klienta</dt>
    <dd class="col-sm-9">
        @(Model.HasReview ? $"{Model.ReviewRating} / 5" : "brak")
    </dd>
</dl>

@if (Model.Status != "Ukończone")
{
    <a asp-action="Edit" asp-route-id="@Model.Id" class="btn btn-primary">Edytuj</a>
}
@if (!Model.IsPaid)
{
    <a asp-controller="Payments" asp-action="Checkout"
       asp-route-id="@Model.Id" class="btn btn-success ms-2">Zapłać</a>
}
@if (!Model.HasReview && Model.Status == "Ukończone")
{
    <a asp-controller="Review" asp-action="Create"
       asp-route-orderId="@Model.Id" class="btn btn-warning ms-2">Oceń usługę</a>
}
<a asp-action="Index" class="btn btn-secondary ms-2">Powrót</a>
